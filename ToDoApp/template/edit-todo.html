{% include 'layout.html' %}

<div class="container">
  <div class="card">
    <div class="card-header">
      Let's edit your todo!
    </div>

    <div class="card-body">

      <!-- UPDATE FORM -->
      <form
        action="/todos/todo/{{ todo.id }}/update"
        method="post"
        onsubmit="disableBtn(this)"
      >

        <div class="form-group">
          <label>Title</label>
          <input
            type="text"
            class="form-control"
            name="title"
            value="{{ todo.title }}"
            required
          >
        </div>

        <div class="form-group">
          <label>Description</label>
          <textarea
            name="description"
            class="form-control"
            rows="3"
            required
          >{{ todo.description }}</textarea>
        </div>

        <div class="form-group">
          <label>Priority</label>
          <select name="priority" class="form-control">
            <option value="1" {% if todo.priority == 1 %}selected{% endif %}>1</option>
            <option value="2" {% if todo.priority == 2 %}selected{% endif %}>2</option>
            <option value="3" {% if todo.priority == 3 %}selected{% endif %}>3</option>
            <option value="4" {% if todo.priority == 4 %}selected{% endif %}>4</option>
            <option value="5" {% if todo.priority == 5 %}selected{% endif %}>5</option>
          </select>
        </div>

        <div class="form-group">
          <label>Status</label>
          <select name="status" class="form-control">
            <option value="todo" {% if todo.status == "todo" %}selected{% endif %}>
              To Do
            </option>
            <option value="completed" {% if todo.status == "completed" %}selected{% endif %}>
              Completed
            </option>
          </select>
        </div>
        

        <!-- BUTTON ROW -->
        <div class="mt-3">

          <button type="submit" class="btn btn-primary">
            Save
          </button>

          <!-- DELETE FORM -->
          <form
            action="/todos/todo/{{ todo.id }}/delete"
            method="post"
            class="d-inline-block ms-2"
            onsubmit="return confirm('Are you sure you want to delete this todo?');"
          >
            <button type="submit" class="btn btn-danger">
              Delete
            </button>
          </form>

          <a href="/todos/todo-page" class="btn btn-success ms-2">
            Back
          </a>

        </div>

      </form>
    </div>
  </div>
</div>

<script>
function disableBtn(form) {
  const btn = form.querySelector("button[type='submit']");
  btn.disabled = true;
  btn.innerText = "Saving...";
}
</script>
